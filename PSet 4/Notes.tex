\documentclass{report}

\input{preamble}
\input{macros}
\input{letterfonts}

\title{\Huge{Math 244}}
\author{\huge{PSET 4}}
\date{Feb 21 2025}

\begin{document}

\maketitle
\newpage% or \cleardoublepage
% \pdfbookmark[<level>]{<title>}{<dest>}
\pdfbookmark[section]{\contentsname}{toc}
\tableofcontents
\pagebreak


\section*{3.2 Prob 1}
\addcontentsline{toc}{section}{3.2 Prob 1}

\qs{}{
  How many permutations of \(\{1,2,\dots,n\}\) have a single cycle?
}

\begin{proofWithHibiscus}
  There are \( n! \) ways to arrange \( n \) distinct elements in a sequence. Any sequence
  \[
  (a_1, a_2, \dots, a_n)
  \]
  can be thought of as a candidate for an \( n \)-cycle when interpreted in cyclic notation as
  \[
  (a_1, a_2, \dots, a_n).
  \]
  
  But we can't count cycles where the order is simply rotated cyclically
  \[
  (a_1, a_2, \dots, a_n)
  \]
  is the same as the cycle
  \[
  (a_2, a_3, \dots, a_n, a_1),
  \]
  there are exactly \( n \) different ways to write the same cycle by cyclically rotating the elements. \\
  
  If we count every sequence as a distinct cycle, we overcount each \( n \)-cycle \( n \) times. \\
    
  To deal with the overcounting we divide the total number of sequences by \( n \). 
  \[
  \frac{n!}{n} = (n-1)!.
  \]
  
\end{proofWithHibiscus}


\section*{3.2 Prob 2}
\addcontentsline{toc}{section}{3.2 Prob 2}

\qs{}{
  For a permutation \( p: X \to X \), let \( p^k \) denote the permutation arising by a \( k \)-fold 
  composition of \( p \), i.e., \( p^1 = p \) and \( p^k = p \circ p^{k-1} \). Define a relation 
  \( \approx \) on the set \( X \) as follows: \( i \approx j \) if and only if there exists a 
  \( k \geq 1 \) such that \( p^k(i) = j \). Prove that \( \approx \) is an equivalence relation 
  on \( X \), and that its classes are the cycles of \( p \).
}

\begin{proofWithHibiscus}
  Want to show that \( \approx \) satisfies the three properties of an equivalence relation: reflexivity, symmetry, and transitivity.

  \medskip
    
  For any \( i \in X \), since \( p \) is a permutation meaning its bijective, \( i \) must belong to some cycle. So, there exists a smallest positive integer \( k \geq 1 \) such that
  \[ p^k(i) = i. \]
  By the definition of \( \approx \), we have \( i \approx i \). So, \( \approx \) is reflexive.
  
  \medskip

  Suppose \( i \approx j \). Then there exists an integer \( k \geq 1 \) such that
  \[ p^k(i) = j. \]
  Since \( p \) is a permutation, it has an inverse \( p^{-1} \). Applying \( p^{-k} \) to both sides, we get
  \[ i = p^{-k}(j). \]
  Since this is also a permutation, there exists some positive integer \( m \) such that \( p^m(j) = i \). Thus, \( j \approx i \), showing that \( \approx \) is symmetric.
  
  \medskip 

  Suppose \( i \approx j \) and \( j \approx k \). Then there exist positive integers \( m \) and \( n \) such that
  \[ p^m(i) = j \quad \text{and} \quad p^n(j) = k. \]
  Now, consider the composition:
  \[ p^{m+n}(i) = p^n(p^m(i)) = p^n(j) = k. \]
  Since \( m+n \geq 1 \), it follows that \( i \approx k \). So, \( \approx \) is transitive.
  
  \bigskip   

  In cycle notation, the cycle containing an element \( i \) is defined as:
  \[\{ i,\, p(i),\, p^2(i),\, \ldots,\, p^{k-1}(i) \}, \]
  where \( k \) is the smallest positive integer such that \( p^k(i) = i \). 

  \bigskip
  
  By our definition of \( \approx \), an element \( j \in X \) is related to \( i \) if and only if there exists some \( k \geq 1 \) such that \( p^k(i) = j \). 
  This is exactly the description of the cycle of \( i \). So, the equivalence 
  class of \( i \) under \( \approx \) is precisely the set of all elements that 
  can be reached from \( i \) by some power of \( p \), which corresponds to the 
  cycle of \( i \).
    
\end{proofWithHibiscus}

\section*{3.3 Prob 7}
\addcontentsline{toc}{section}{3.3 Prob 7}

\qs{}{
  How many functions \( f: \{1,2, \dots, n\} \to \{1,2, \dots, n\} \) are there 
  that are \textit{monotonic}; that is, for \( i < j \) we have \( f(i) \leq f(j) \)? 
  \textit{The textbook has a hint to this problem in the back.}
}

\begin{proofWithHibiscus} 
  A monotonic function 
  \[
  f: \{1,2,\dots,n\} \to \{1,2,\dots,n\}
  \]
  satisfies 
  \[
  f(1) \le f(2) \le \cdots \le f(n).
  \]
  So, the function is completely determined by the non-decreasing sequence 
  \[
  (f(1), f(2), \dots, f(n)),
  \]
  where each \( f(i) \) is in \(\{1,2,\dots,n\}\).
  
  Define \(x_k\) as the number of times the value \(k\) appears in the sequence. Then we have
  \[
  x_1 + x_2 + \cdots + x_n = n, \quad \text{with} \quad x_k \geq 0.
  \]
  The number of solutions to this equation in nonnegative integers is given by the stars and bars formula:
  \[
  \binom{n + n - 1}{n - 1} = \binom{2n-1}{n-1}.
  \]
  
\end{proofWithHibiscus}

\section*{3.3 Prob 21}
\addcontentsline{toc}{section}{3.3 Prob 21}

\qs{}{
  (optional bonus problem) Draw a triangle \( ABC \). Draw \( n \) points lying on the side \( AB \) (but different from \( A \) and \( B \)) and connect them all by segments to the vertex \( C \). Similarly, draw \( n \) points on the side \( AC \) and connect them to \( B \).
    
  \begin{enumerate}
    \item How many intersections of the drawn segments are there? Into how many regions is the triangle \( ABC \) partitioned by the drawn segments?

    \item Draw \( n \) points on the side \( BC \) and connect them to \( A \). Assume that no 3 of the drawn segments intersect at a single point. How many intersections are there now?

    \item How many regions are there in the situation of (b)?
  \end{enumerate}
}

\subsection*{Bonus Prob Part 1}
\addcontentsline{toc}{subsection}{Bonus Prob Part 1}

\begin{RemarkWithLily}{Part a}
  FFirst, place \(n\) points (\(P_1, P_2, \dots, P_n\)) on side \(AB\) and \(n\) points (\(Q_1, Q_2, \dots, Q_n\)) on side \(AC\).  
  Draw segments \(CP_i\) for \(i=1,\dots,n\) and segments \(BQ_j\) for \(j=1,\dots,n\).  
  Since every segment from \(C\) to a point on \(AB\) meets every segment from \(B\) to a point on \(AC\) exactly once, there are
  \[
  n \times n = n^2
  \]
  intersections. These segments divide the triangle into a grid-like pattern having \((n+1)\) rows and \((n+1)\) columns, so the total number of regions is
  \[
  (n+1)^2.
  \]

  \bigskip

  \textbf{Diagram for (a):}

  \bigskip

  \begin{center}
  \begin{tikzpicture}[scale=1]
    % Define triangle vertices
    \coordinate (A) at (0,0);
    \coordinate (B) at (6,0);
    \coordinate (C) at (2,4);
    
    % Draw triangle ABC
    \draw[line width=1pt] (A) -- (B) -- (C) -- cycle;
    \node[below left] at (A) {\(A\)};
    \node[below right] at (B) {\(B\)};
    \node[above] at (C) {\(C\)};
    
    % Set n=3 for illustration
    \def\n{3}
    
    % Points on AB: P_1, P_2, ..., P_n
    \foreach \i in {1,...,\n} {
      \coordinate (P\i) at ($(A)!{\i/(\n+1)}!(B)$);
      \fill (P\i) circle (2pt);
      \node[below] at (P\i) {\(P_{\i}\)};
      % Draw segment from P_i to C
      \draw[dashed] (P\i) -- (C);
    }
    
    % Points on AC: Q_1, Q_2, ..., Q_n
    \foreach \i in {1,...,\n} {
      \coordinate (Q\i) at ($(A)!{\i/(\n+1)}!(C)$);
      \fill (Q\i) circle (2pt);
      \node[left] at (Q\i) {\(Q_{\i}\)};
      % Draw segment from Q_i to B
      \draw[dashed] (Q\i) -- (B);
    }
    
  \end{tikzpicture}
  \end{center}
\end{RemarkWithLily}


\newpage

\subsection*{Bonus Prob Part 2}
\addcontentsline{toc}{subsection}{Bonus Prob Parts 2 and 3}

\begin{RemarkWithLily}{For Prob 2 and 3}
  NNow, we add \(n\) points ( \(R_1, R_2, \dots, R_n\)) on side \(BC\) and draw segments \(AR_i\) from each to vertex \(A\). Under the assumption that no three segments are concurrent, each new segment \(AR_i\) intersects every segment from \(C\) to \(AB\) making \(n\) segement and every segment from \(B\) to \(AC\) making \(n\) segements. So, each segment \(AR_i\) contributes \(2n\) new intersections. Since there are \(n\) such segments, the additional intersections amount to
  \[
  n \cdot (2n) = 2n^2.
  \]
  We add these to the orginal $^{2}$ intersections
  \[
  n^2 + 2n^2 = 3n^2.
  \]
  \bigskip

  \textbf{Diagram for (b) and (c):}

  \bigskip

  \begin{center}
  \begin{tikzpicture}[scale=1]
    % Define triangle vertices
    \coordinate (A) at (0,0);
    \coordinate (B) at (6,0);
    \coordinate (C) at (2,4);
    
    % Draw triangle ABC
    \draw[line width=1pt] (A) -- (B) -- (C) -- cycle;
    \node[below left] at (A) {\(A\)};
    \node[below right] at (B) {\(B\)};
    \node[above] at (C) {\(C\)};
    
    % Set n=3 for illustration
    \def\n{3}
    
    % Points on AB: P_1, P_2, ..., P_n
    \foreach \i in {1,...,\n} {
      \coordinate (P\i) at ($(A)!{\i/(\n+1)}!(B)$);
      \fill (P\i) circle (2pt);
      \node[below] at (P\i) {\(P_{\i}\)};
      % Draw segment from P_i to C
      \draw[dashed] (P\i) -- (C);
    }
    
    % Points on AC: Q_1, Q_2, ..., Q_n
    \foreach \i in {1,...,\n} {
      \coordinate (Q\i) at ($(A)!{\i/(\n+1)}!(C)$);
      \fill (Q\i) circle (2pt);
      \node[left] at (Q\i) {\(Q_{\i}\)};
      % Draw segment from Q_i to B
      \draw[dashed] (Q\i) -- (B);
    }
    
    % Points on BC: R_1, R_2, ..., R_n
    \foreach \i in {1,...,\n} {
      \coordinate (R\i) at ($(B)!{\i/(\n+1)}!(C)$);
      \fill (R\i) circle (2pt);
      \node[right] at (R\i) {\(R_{\i}\)};
      % Draw segment from R_i to A
      \draw[dashed] (R\i) -- (A);
    }
    
  \end{tikzpicture}
  \end{center}

\end{RemarkWithLily}

\subsection*{Bonus Prob Part 3}
\addcontentsline{toc}{subsection}{Bonus Prob Part 3}

\begin{RemarkWithLily}{For part 3}
  WWhen a new segment is added, if it is intersected \(k\) times, it is divided 
  into \(k+1\) piecesâ€”each piece increasing the number of regions by 1. 
  Each segment \(AR_i\) is intersected \(2n\) times and splits into \(2n+1\) pieces. So, these $n$ segements add
  \[
  n(2n+1)
  \]
  regions. The total number of regions is 
  \[
  (n+1)^2 + n(2n+1) = 3n^2+3n+1.
  \]

  
\end{RemarkWithLily}

\section*{3.7 Prob 3}
\addcontentsline{toc}{section}{3.7 Prob 3}

\qs{}{
  (Sieve of Eratosthenes) How many numbers are left in the set 
  \(\{1,2,\dots,1000\}\) after all multiples of 2, 3, 5, and 7
  are crossed out?
}

\begin{RemarkWithLily}{For Prob 4}
  DDefine:

  \begin{itemize}
      \item \(A_2\) as the set of multiples of 2,
      \item \(A_3\) as the set of multiples of 3,
      \item \(A_5\) as the set of multiples of 5,
      \item \(A_7\) as the set of multiples of 7.
  \end{itemize}
  
  We want the size of the complement of \(A_2 \cup A_3 \cup A_5 \cup A_7\)
  
  We cound the multiples of \(2,3,5,7 \) in the range of [1,1000].

  \[
  |A_2| = \left\lfloor \frac{1000}{2} \right\rfloor = 500, \quad 
  |A_3| = \left\lfloor \frac{1000}{3} \right\rfloor = 333, \quad 
  |A_5| = \left\lfloor \frac{1000}{5} \right\rfloor = 200, \quad 
  |A_7| = \left\lfloor \frac{1000}{7} \right\rfloor = 142.
  \]
  
  count of multiples for pairs using least common multiple:
  \[
  |A_2 \cap A_3| = \left\lfloor \frac{1000}{6} \right\rfloor = 166, \quad
  |A_2 \cap A_5| = \left\lfloor \frac{1000}{10} \right\rfloor = 100, \quad
  |A_2 \cap A_7| = \left\lfloor \frac{1000}{14} \right\rfloor = 71, \] 
  \[ 
  |A_3 \cap A_5| = \left\lfloor \frac{1000}{15} \right\rfloor = 66, \quad
  |A_3 \cap A_7| = \left\lfloor \frac{1000}{21} \right\rfloor = 47, \quad
  |A_5 \cap A_7| = \left\lfloor \frac{1000}{35} \right\rfloor = 28.
  \]
  
  Count of multiples for triples
  \[
  |A_2 \cap A_3 \cap A_5| = \left\lfloor \frac{1000}{30} \right\rfloor = 33, \quad
  |A_2 \cap A_3 \cap A_7| = \left\lfloor \frac{1000}{42} \right\rfloor = 23, \] 
  \[ 
  |A_2 \cap A_5 \cap A_7| = \left\lfloor \frac{1000}{70} \right\rfloor = 14, \quad
  |A_3 \cap A_5 \cap A_7| = \left\lfloor \frac{1000}{105} \right\rfloor = 9.
  \]
  
  Count of multiples which all four share 
  \[
  |A_2 \cap A_3 \cap A_5 \cap A_7| = \left\lfloor \frac{1000}{210} \right\rfloor = 4.
  \]
  
  Apply the Inclusion-Exclusion Principle
  
  The count of numbers divisible by at least one of \(2,3,5,7\) is:
  
  \[
  \begin{aligned}
  |A_2 \cup A_3 \cup A_5 \cup A_7| &= |A_2|+|A_3|+|A_5|+|A_7| \\
  &\quad - \Bigl(|A_2 \cap A_3| + |A_2 \cap A_5| + |A_2 \cap A_7| + |A_3 \cap A_5| + |A_3 \cap A_7| + |A_5 \cap A_7|\Bigr)\\
  &\quad + \Bigl(|A_2 \cap A_3 \cap A_5| + |A_2 \cap A_3 \cap A_7| + |A_2 \cap A_5 \cap A_7| + |A_3 \cap A_5 \cap A_7|\Bigr)\\
  &\quad - |A_2 \cap A_3 \cap A_5 \cap A_7|.
  \end{aligned}
  \]
  
  \[
  \begin{aligned}
  |A_2 \cup A_3 \cup A_5 \cup A_7| &= 500 + 333 + 200 + 142 \\
  &\quad - (166 + 100 + 71 + 66 + 47 + 28) \\
  &\quad + (33 + 23 + 14 + 9) \\
  &\quad - 4.
  \end{aligned}
  \]
  
  \[
  \begin{aligned}
  500+333+200+142 &= 1175, \\
  166+100+71+66+47+28 &= 478, \\
  33+23+14+9 &= 79.
  \end{aligned}
  \]
  
  \[
  |A_2 \cup A_3 \cup A_5 \cup A_7| = 1175 - 478 + 79 - 4.
  \]
  
  \[
  \begin{aligned}
  1175 - 478 &= 697, \quad 
  697 + 79 &= 776, \quad
  776 - 4 &= 772.
  \end{aligned}
  \]
  
  The count of numbers \textbf{not} divisible by 2, 3, 5, or 7 is:
  \[
  1000 - 772 = 228.
  \]

\end{RemarkWithLily}

\section*{3.8 Prob 4}
\addcontentsline{toc}{section}{3.8 Prob 4}

\qs{}{
  Prove the equation
    \[
    D(n) = n! - nD(n-1) - \binom{n}{2} D(n-2) - \dots - \binom{n}{n-1} D(1) - 1.
    \]
}

\begin{proofWithHibiscus}
  Suppose a permutation of \(\{1,2,\dots,n\}\) has exactly \(i\) fixed points. 
  There are \(\binom{n}{i}\) ways to choose these fixed points. 
  The remaining \(n-i\) elements must form a derangement, which can be done in \(D(n-i)\) ways.

  \medskip 

  Therefore, the total number of permutations of \(n\) elements can be written as
  \[
  \sum_{i=0}^{n} \binom{n}{i} D(n-i) = n!.
  \]
  
  \bigskip

  Let \(j=n-i\). Then as \(i\) runs from 0 to \(n\), so does \(j\). Since the binomial coefficient is symmetric
  \[
  \sum_{j=0}^{n} \binom{n}{j} D(j) = n!.
  \]
  
  Expanding
  \[
  \binom{n}{0}D(0)+\binom{n}{1}D(1)+\cdots+\binom{n}{n-1}D(n-1)+\binom{n}{n}D(n) = n!.
  \]
  
  Since \(\binom{n}{0} = 1\) and \(\binom{n}{n} = 1\), and \(D(0)=1\), we have:
  \[
  1 \cdot 1 + \binom{n}{1}D(1)+\cdots+\binom{n}{n-1}D(n-1) + 1 \cdot D(n) = n!.
  \]
  
  \bigskip
  
  Solve for \(D(n)\) by subtractracting the contributions of \(D(0), D(1), \dots, D(n-1)\) from both sides:
  \[
  D(n) = n! - \left[\binom{n}{1}D(1)+\binom{n}{2}D(2)+\cdots+\binom{n}{n-1}D(n-1)+ \binom{n}{0}D(0)\right].
  \]
  
  Since \(\binom{n}{0}D(0)=1\)
  \[
  D(n) = n! - \binom{n}{1}D(n-1) - \binom{n}{2}D(n-2) - \dots - \binom{n}{n-1}D(1) - 1.
  \]
  
  
\end{proofWithHibiscus}

\end{document}